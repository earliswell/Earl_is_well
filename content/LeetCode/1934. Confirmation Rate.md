---
Number: 1934. Confirmation Rate
draft: 
tags:
  - 코테
  - 데이터베이스
  - 알고리즘
website: https://leetcode.com/problems/confirmation-rate/description/?envType=study-plan-v2&envId=top-sql-50
---
## Problem
The **confirmation rate** of a user is the number of `'confirmed'` messages divided by the total number of requested confirmation messages. The confirmation rate of a user that did not request any confirmation messages is `0`. Round the confirmation rate to **two decimal** places.

Write a solution to find the **confirmation rate** of each user.

Return the result table in **any order**.

The result format is in the following example.


## My Answer.
```python
import pandas as pd

def confirmation_rate(signups: pd.DataFrame, confirmations: pd.DataFrame) -> pd.DataFrame:
	
	df = pd.merge(signups, confirmations, how='outer', on='user_id')
	df['confirm'] = np.where(df['action'] == 'confirmed', 1, 0)
	
	total = df.groupby(['user_id'])[['action']].count().reset_index().rename(columns={'action':'total'})
	count = df.groupby(['user_id'])[['confirm']].sum().reset_index()
	
	final = count.merge(total, how='left', on='user_id')
	final['confirmation_rate'] = final['confirm'] / final['total']
	final['confirmation_rate'] = final['confirmation_rate'].fillna(0).round(2)
	
	return final[['user_id', 'confirmation_rate']]
```
