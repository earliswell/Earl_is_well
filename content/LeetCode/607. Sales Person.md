---
Number: Untitled
draft: 
tags:
  - 코테
  - 데이터베이스
  - 알고리즘
website: https://leetcode.com/problems/friend-requests-ii-who-has-the-most-friends/
---
## Problem

Write a solution to find the names of all the salespersons who did not have any orders related to the company with the name **"RED"**.

Return the result table in **any order**.

The result format is in the following example.

## My Answer.
```python
import pandas as pd

def sales_person(sales_person: pd.DataFrame, company: pd.DataFrame, orders: pd.DataFrame) -> pd.DataFrame:
	
	df_merge = pd.merge(orders, sales_person, how='inner', on='sales_id')
	df_final = pd.merge(df_merge, company, how='inner', on='com_id')[['name_x', 'name_y']]
	red_list = df_final[df_final['name_y'] == "RED"]['name_x'].tolist()
	
	return sales_person[~sales_person['name'].isin(red_list)][['name']]
```

### Others Solutions
```python
import pandas as pd

def sales_person(sales_person: pd.DataFrame, company: pd.DataFrame, orders: pd.DataFrame) -> pd.DataFrame:
    red_company_id = company[company['name']=='RED']['com_id']
    if red_company_id.empty:
        return sales_person[['name']]
    else:
        red_sales = orders[orders['com_id']==red_company_id.item()]['sales_id']
        return sales_person[~sales_person['sales_id'].isin(red_sales)][['name']]
```
